{% extends "base.html" %}

{% block title %}Chat{% endblock %}
{% block body_class %}bg-hero{% endblock %}

{% block content %}
<section class="messages-shell">
  <div class="header-row">
    <div>
      <p class="subtitle">Chatbot</p>
      <h1 class="headline">{{ tipo }}</h1>
    </div>
  </div>

  <div class="messages-box" id="msgBox">
    {% for msg in historial %}
      <div class="msg {% if msg.sender == 'user' %}msg--mine{% endif %}">
        <div class="msg__meta">{{ msg.sender|capfirst }}</div>
        <div class="msg__body">{{ msg.text }}</div>
      </div>
    {% endfor %}
  </div>

  <form method="POST" class="composer">
    {% csrf_token %}
    <input type="text" name="mensaje" placeholder="Escribe un mensaje..." required>
    <button type="submit" class="btn btn-primary btn-small">Enviar</button>
  </form>
</section>

<script>
  const box = document.getElementById("msgBox");
  if (box) box.scrollTop = box.scrollHeight;
</script>

{% endblock %}
